<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Design_files/filelist.xml">
<link rel=Edit-Time-Data href="./Design_files/editdata.mso">
<link rel=OLE-Object-Data href="./Design_files/oledata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Design</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Lee Thomason</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Brian Duisenberg</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>606</o:TotalTime>
  <o:LastPrinted>1999-11-04T00:48:00Z</o:LastPrinted>
  <o:Created>1999-11-04T02:57:00Z</o:Created>
  <o:LastSaved>2000-01-15T01:28:00Z</o:LastSaved>
  <o:Pages>14</o:Pages>
  <o:Words>5004</o:Words>
  <o:Characters>28523</o:Characters>
  <o:Company>Middlesoft, Inc.</o:Company>
  <o:Lines>237</o:Lines>
  <o:Paragraphs>57</o:Paragraphs>
  <o:CharactersWithSpaces>35028</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>144</w:Zoom>
  <w:DoNotHyphenateCaps/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:UsePrinterMetrics/>
   <w:WW6BorderRules/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	font-variant:small-caps;
	mso-font-kerning:14.0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	color:teal;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	color:blue;
	mso-bidi-font-weight:normal;}
h4
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	color:blue;
	mso-bidi-font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:10.0pt;
	font-family:Arial;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-font-weight:normal;}
h6
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-weight:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:10.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:20.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:30.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:40.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:50.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:70.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:80.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:2.5in;
	margin-left:0in;
	text-align:center;
	line-height:30.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	border:none;
	mso-border-bottom-alt:solid gray .75pt;
	padding:0in;
	mso-padding-alt:0in 0in 14.0pt 0in;
	font-size:24.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Black";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:gray;
	letter-spacing:-1.75pt;
	mso-font-kerning:14.0pt;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-parent:Title;
	mso-style-next:"Body Text";
	margin-top:97.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:10.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	border:none;
	mso-border-bottom-alt:solid gray .75pt;
	padding:0in;
	mso-padding-alt:0in 0in 14.0pt 0in;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Garamond;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:gray;
	text-transform:uppercase;
	letter-spacing:1.5pt;
	mso-font-kerning:14.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:2.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoBodyTextIndent3, li.MsoBodyTextIndent3, div.MsoBodyTextIndent3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:blue;}
p.CompanyName, li.CompanyName, div.CompanyName
	{mso-style-name:"Company Name";
	mso-style-next:Normal;
	margin-top:21.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-line-height-alt:16.0pt;
	mso-pagination:widow-orphan;
	font-size:19.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Garamond;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	text-transform:uppercase;
	mso-font-kerning:18.0pt;}
p.ReturnAddress, li.ReturnAddress, div.ReturnAddress
	{mso-style-name:"Return Address";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Garamond;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:-.15pt;}
p.SubtitleCover, li.SubtitleCover, div.SubtitleCover
	{mso-style-name:"Subtitle Cover";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:264.0pt;
	margin-left:0in;
	line-height:24.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	border:none;
	mso-border-top-alt:solid windowtext .75pt;
	padding:0in;
	mso-padding-alt:1.0pt 0in 0in 0in;
	font-size:22.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Garamond;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	letter-spacing:-.75pt;
	mso-font-kerning:14.0pt;}
p.TitleCover, li.TitleCover, div.TitleCover
	{mso-style-name:"Title Cover";
	mso-style-next:"Subtitle Cover";
	margin-top:0in;
	margin-right:30.0pt;
	margin-bottom:0in;
	margin-left:30.0pt;
	margin-bottom:.0001pt;
	text-align:right;
	line-height:72.0pt;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-alt:solid white .75pt;
	padding:0in;
	mso-padding-alt:31.0pt 31.0pt 31.0pt 31.0pt;
	font-size:72.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Garamond;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;}
@page Section1
	{size:8.5in 11.0in;
	margin:48.0pt 48.0pt 48.0pt 48.0pt;
	mso-header-margin:0in;
	mso-footer-margin:0in;
	mso-page-numbers:0;
	mso-title-page:yes;
	mso-footer:url("./Design_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
@page Section2
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-footer:url("./Design_files/header.htm") f2;
	mso-paper-source:0;}
div.Section2
	{page:Section2;}
 /* List Definitions */
@list l0
	{mso-list-id:-2;
	mso-list-type:simple;
	mso-list-template-ids:-1;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-text:*;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:0in;
	text-indent:0in;}
@list l1
	{mso-list-id:82845344;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:92630750;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l2:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:175655758;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4
	{mso-list-id:383871104;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l4:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l5
	{mso-list-id:540096306;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:576673058;
	mso-list-template-ids:2019738484;}
@list l6:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l6:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l6:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l6:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l6:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l6:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l6:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l6:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l7
	{mso-list-id:611742718;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l7:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l8
	{mso-list-id:836698545;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l8:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:898440334;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10
	{mso-list-id:940651341;
	mso-list-template-ids:-1026234966;}
@list l10:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l10:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l10:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l10:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l10:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l10:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l10:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l10:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l10:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l11
	{mso-list-id:1039015565;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l11:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l12
	{mso-list-id:1120148135;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l12:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l13
	{mso-list-id:1130367983;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l13:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l14
	{mso-list-id:1222475146;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l14:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l15
	{mso-list-id:1567761230;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l15:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l16
	{mso-list-id:1721320839;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l16:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l17
	{mso-list-id:1817602180;
	mso-list-type:simple;
	mso-list-template-ids:67698703;}
@list l17:level1
	{mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l18
	{mso-list-id:2023313844;
	mso-list-type:simple;
	mso-list-template-ids:67698689;}
@list l18:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10:level1 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l10:level2 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l10:level3 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l10:level4 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l10:level5 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l10:level6 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l10:level7 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l10:level8 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l10:level9 lfo3
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l6:level1 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l6:level3 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l6:level4 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l6:level5 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l6:level6 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l6:level7 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l6:level8 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l6:level9 lfo9
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l6:level1 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l6:level3 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l6:level4 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l6:level5 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l6:level6 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l6:level7 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l6:level8 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l6:level9 lfo10
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l6:level1 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;}
@list l6:level2 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.5in;
	text-indent:-.25in;}
@list l6:level3 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:45.0pt;
	text-indent:-9.0pt;}
@list l6:level4 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:63.0pt;
	text-indent:-.25in;}
@list l6:level5 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:81.0pt;
	text-indent:-.25in;}
@list l6:level6 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:1.25in;
	text-indent:-9.0pt;}
@list l6:level7 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.5in;
	text-indent:-.25in;}
@list l6:level8 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:1.75in;
	text-indent:-.25in;}
@list l6:level9 lfo11
	{mso-level-numbering:continue;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:9.0pt;
	mso-level-legacy-space:6.0pt;
	margin-left:135.0pt;
	text-indent:-9.0pt;}
@list l0:level1 lfo15
	{mso-level-number-format:bullet;
	mso-level-numbering:continue;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level1 lfo36
	{mso-level-number-format:bullet;
	mso-level-numbering:continue;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	mso-level-legacy:yes;
	mso-level-legacy-indent:.25in;
	mso-level-legacy-space:0in;
	margin-left:0in;
	text-indent:0in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1031"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><!--[if gte vml 1]><v:shapetype id="_x0000_t75" coordsize="21600,21600"
 o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f"
 stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:102pt;
 height:34.5pt' fillcolor="window">
 <v:imagedata src="./Design_files/image001.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=136 height=46
src="./Design_files/image002.jpg" v:shapes="_x0000_i1025"><![endif]></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<div style='border:none;border-top:solid windowtext .75pt;padding:1.0pt 0in 0in 0in'>

<p class=SubtitleCover style='line-height:24.0pt;mso-line-height-rule:exactly'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<div style='border:solid white .75pt;padding:31.0pt 31.0pt 31.0pt 31.0pt'>

<p class=TitleCover style='margin-top:0in;margin-right:30.25pt;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt;line-height:normal'>Flash Porting SDK
: Design</p>

</div>

</div>

<span style='font-size:72.0pt;mso-bidi-font-size:10.0pt;font-family:Garamond;
mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
mso-font-kerning:14.0pt;mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always;
mso-break-type:section-break'>
</span>

<div class=Section2>

<div style='border:none;border-bottom:solid gray .75pt;padding:0in 0in 14.0pt 0in'>

<p class=MsoSubtitle>Macromedia</p>

<p class=MsoTitle style='line-height:30.0pt;mso-line-height-rule:exactly'>File
Porting SDK : Design</p>

</div>

<p class=ReturnAddress><span style='font-family:Symbol;mso-ascii-font-family:
Garamond;mso-hansi-font-family:Garamond;mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>ã</span></span>
Macromedia, Incorporated</p>

<p class=ReturnAddress>600 Townsend Street</p>

<p class=ReturnAddress>San Francisco, California 94103</p>

<p class=ReturnAddress><span lang=FR style='letter-spacing:0pt;mso-ansi-language:
FR'>Tel (415) 252-2000</span><span lang=FR style='mso-ansi-language:FR'> • </span><span
lang=FR style='letter-spacing:0pt;mso-ansi-language:FR'>Fax (415) 626-0554</span><span
lang=FR style='mso-ansi-language:FR'><o:p></o:p></span></p>

<span lang=FR style='font-size:14.0pt;mso-bidi-font-size:10.0pt;font-family:
Arial;mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
color:teal;mso-ansi-language:FR;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:always'>
</span>

<h2><a name="_Toc463333514"></a><a name="_Toc463949602"></a><a
name="_Toc465251239"><span style='mso-bookmark:_Toc463949602'><span
style='mso-bookmark:_Toc463333514'><span lang=FR style='mso-ansi-language:FR'>Contents</span></span></span></a><span
lang=FR style='mso-ansi-language:FR'><o:p></o:p></span></h2>

<p class=MsoToc2 style='tab-stops:right lined 431.5pt'><!--[if supportFields]><span
style='mso-element:field-begin'></span><span lang=FR style='mso-ansi-language:
FR'><span style="mso-spacerun: yes"> </span>TOC \o &quot;1-4&quot; </span><span
style='mso-element:field-separator'></span><![endif]--><span lang=FR
style='mso-ansi-language:FR'>Contents<span style='mso-tab-count:1 lined'>_____________________________________________________________ </span></span><!--[if supportFields]><span
style='mso-element:field-begin'></span><span style='mso-ansi-language:FR'> <span
lang=FR>PAGEREF _Toc465251239 \h </span></span><span style='mso-element:field-separator'></span><![endif]--><span
lang=FR style='mso-ansi-language:FR'>2</span><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200330039000000</w:data>
</xml><![endif]--><!--[if supportFields]><span style='mso-element:field-end'></span><![endif]--><span
lang=FR style='mso-ansi-language:FR'><o:p></o:p></span></p>

<p class=MsoToc2 style='tab-stops:right lined 431.5pt'>Overview<span
style='mso-tab-count:1 lined'>_____________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251240 \\h"'>3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340030000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc2 style='tab-stops:right lined 431.5pt'>General Notes<span
style='mso-tab-count:1 lined'>_________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251241 \\h"'>3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340031000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>Requirements of the Host
Platform<span style='mso-tab-count:1 lined'>___________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251242 \\h"'>3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340032000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>Notation<span
style='mso-tab-count:1 lined'>______________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251243 \\h"'>4<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340033000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>Directory Structure<span
style='mso-tab-count:1 lined'>______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251244 \\h"'>4<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340034000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'><span style='layout-grid-mode:
line'>#defines</span><span style='mso-tab-count:1 lined'>______________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251245 \\h"'>5<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340035000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc2 style='tab-stops:right lined 431.5pt'>Major Flash Player
Components<span style='mso-tab-count:1 lined'>__________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251246 \\h"'>6<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340036000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'><span style='mso-tab-count:
1 lined'>_____________________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251247 \\h"'>6<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340037000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>Global.h<span
style='mso-tab-count:1 lined'>_______________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251248 \\h"'>6<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340038000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class Splayer<span
style='mso-tab-count:1 lined'>___________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251249 \\h"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200340039000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class NativePlayerWnd :
public Splayer<span style='mso-tab-count:1 lined'>_______________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251250 \\h"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350030000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>Method calls from Flash
Core to NativePlayerWnd<span style='mso-tab-count:1 lined'>_____________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251251 \\h"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350031000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>Method calls from
NativePlayerWnd to SPlayer<span style='mso-tab-count:1 lined'>_______________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251252 \\h"'>8<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350032000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>Streaming<span
style='mso-tab-count:1 lined'>___________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251253 \\h"'>10<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350033000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class SParser<span
style='mso-tab-count:1 lined'>__________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251254 \\h"'>11<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350034000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class ScriptThread :
public SParser<span style='mso-tab-count:1 lined'>__________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251255 \\h"'>11<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350035000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class ScriptPlayer :
public ScriptThread<span style='mso-tab-count:1 lined'>______________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251256 \\h"'>11<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350036000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class DisplayList<span
style='mso-tab-count:1 lined'>_______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251257 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350037000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>struct SObject<span
style='mso-tab-count:1 lined'>_________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251258 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350038000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class CRaster<span
style='mso-tab-count:1 lined'>__________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251259 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200350039000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class CBitBuffer<span
style='mso-tab-count:1 lined'>________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251260 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360030000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class NativeBitmap<span
style='mso-tab-count:1 lined'>______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251261 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360031000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class
NativeDisplayTester<span style='mso-tab-count:1 lined'>________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251262 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360032000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class NativePalette<span
style='mso-tab-count:1 lined'>______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251263 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360033000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>struct SColorInfo<span
style='mso-tab-count:1 lined'>_______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251264 \\h"'>12<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360034000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class CSound<span
style='mso-tab-count:1 lined'>__________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251265 \\h"'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360035000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class CSoundChannel<span
style='mso-tab-count:1 lined'>___________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251266 \\h"'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360036000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class CSoundMix<span
style='mso-tab-count:1 lined'>_______________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251267 \\h"'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360037000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc3 style='tab-stops:right lined 431.5pt'>class NativeSoundMix :
public CSoundMix<span style='mso-tab-count:1 lined'>____________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251268 \\h"'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360038000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>Architecture of the
Sound System<span style='mso-tab-count:1 lined'>________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251269 \\h"'>13<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200360039000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>Analysis of Win32 Sample
Code<span style='mso-tab-count:1 lined'>__________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251270 \\h"'>14<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200370030000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoToc4 style='tab-stops:right lined 431.5pt'>MP3<span
style='mso-tab-count:1 lined'>_______________________________________________________________________ </span><span
style='mso-field-code:"PAGEREF _Toc465251271 \\h"'>15<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400360035003200350031003200370031000000</w:data>
</xml><![endif]--></span></p>

<p class=MsoNormal style='tab-stops:4.0in'><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]--><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<span style='font-size:16.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;
mso-fareast-font-family:"Times New Roman";mso-bidi-font-family:"Times New Roman";
font-variant:small-caps;mso-font-kerning:14.0pt;mso-ansi-language:EN-US;
mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br clear=all
style='page-break-before:always'>
</span>

<h1><a name="_Toc465251240"><span style='font-variant:normal;text-transform:
uppercase'>Version 1.0 of the Flash 4 Porting SDK<o:p></o:p></span></a></h1>

<h2 style='margin-top:0in'><!--[if gte vml 1]><v:line id="_x0000_s1026"
 style='position:absolute;z-index:1;mso-position-horizontal-relative:text;
 mso-position-vertical-relative:text' from="12pt,5.4pt" to="489pt,5.4pt"
 o:allowincell="f"/><![endif]--><![if !vml]><span style='mso-ignore:vglayout;
position:absolute;z-index:0;margin-left:15px;margin-top:6px;width:639px;
height:3px'><img width=639 height=3 src="./Design_files/image003.gif" v:shapes="_x0000_s1026"></span><![endif]><span
style='mso-bookmark:_Toc465251240'>Overview</span></h2>

<p class=MsoNormal>The <b style='mso-bidi-font-weight:normal'>Porting SDK</b>
contains a modified version of the Flash Player designed to help a 3<sup>rd</sup>
party easily port Flash to any platform or application, as well as the
documentation to perform this task. The code in the Porting SDK is a partial
rewrite of the Flash 4 code, modified for ease of porting and platform
independence. The Porting SDK has been cleanly separated into Flash core code
and (minimal) Native code that must be rewritten for every port.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.25in;mso-list:l10 level1 lfo2;
tab-stops:.5in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]><b style='mso-bidi-font-weight:normal'>Platform specific</b>
(Native) parts need to be re-written when ported</p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.25in;mso-list:l10 level1 lfo3;
tab-stops:.5in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]><b style='mso-bidi-font-weight:normal'>Platform independent </b>code
is the core of Flash and should not need to be changed. </p>

<p class=MsoHeader style='tab-stops:.75in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:.75in'>There are several documents
explaining the code and the porting process. A complete list of documents
shipped with this version is in the Readme.doc file. The main documents are:</p>

<p class=MsoNormal style='tab-stops:.75in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.25in;mso-list:l4 level1 lfo5;
tab-stops:list .5in left .75in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>The <b style='mso-bidi-font-weight:normal'>Design </b>document.
This document. An overview of the Flash Porting code.</p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.25in;mso-list:l4 level1 lfo5;
tab-stops:list .5in left .75in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>The <b style='mso-bidi-font-weight:normal'>Roadmap </b>document,
informal step by step instructions about porting Flash.</p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.25in;mso-list:l4 level1 lfo5;
tab-stops:list .5in left .75in'><![if !supportLists]>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>The <b style='mso-bidi-font-weight:normal'>Reference </b>document,
in html, which is a reference to all the method calls in the Native Flash code,
and related methods in core code.</p>

<p class=MsoHeader style='tab-stops:.75in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='tab-stops:.75in'>When beginning to port the code, it
probably makes sense to start with this document, read it as an overview, and
then actually use the Roadmap to port the player. While porting the player,
refer to the Reference for details about the various method calls that need to
be implemented.</p>

<h2><a name="_Toc463333517"></a><a name="_Toc463949605"></a><a
name="_Toc465251241"><span style='mso-bookmark:_Toc463949605'><span
style='mso-bookmark:_Toc463333517'>General Notes</span></span></a></h2>

<p class=MsoNormal>The Flash Porting SDK is written in standard C++. Flash does
not use the newer features of C++ (RTTI and exceptions, for instance) but does
use inheritance, polymorphism, and other object oriented features.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The Flash core code is a single thread. For network
streaming and sound the native code may wish to start additional threads, but
this is not supported in the Flash core. The exception is the sound system
which does have hooks to allow multiple threads to access the same data. (But
certainly does not require multiple threads.)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This section covers general Flash porting topics such as the
assumptions about the host system, notation, structure, and compilation
options.</p>

<h3><a name="_Toc465251242">Requirements of the Host Platform</a> </h3>

<p class=MsoNormal>It is assumed that the target platform is:</p>

<p class=MsoNormal style='margin-left:20.4pt;text-indent:-.25in;mso-list:l16 level1 lfo7;
tab-stops:list 20.4pt'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>A message/event driven architecture.</p>

<p class=MsoNormal style='margin-left:20.4pt;text-indent:-.25in;mso-list:l16 level1 lfo7;
tab-stops:list 20.4pt'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>At least 32bits.</p>

<p class=MsoNormal style='margin-left:2.4pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>That said, <span style='layout-grid-mode:line'>both of these
restrictions can be overcome. NativePlayerWnd completely encapsulates the
operating system event loop; so a “traditional” (not event-driven) architecture
could be set up as an infinite loop that drives Flash. By polling the state of
the system and creating timer code, Flash core would never know the difference.<o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>The difficulties
involved in a using a 16-bit system are what one would expect: numeric overrun and
problems allocating large blocks of memory.</span> Numeric overrun occurs in
regard to mathematical operations. See especially Fixed.h. It is difficult to
assess where problems will occur with large memory allocation. Certainly the
screen buffer is an obvious concern, but likely there will be other problems.</p>

<h3><a name="_Toc463333519"></a><a name="_Toc463949607"></a><a
name="_Toc465251243"><span style='mso-bookmark:_Toc463949607'><span
style='mso-bookmark:_Toc463333519'>Notation</span></span></a> </h3>

<p class=MsoNormal>In order to promote and maintain some consistency of style
in the code, the following conventions are used in Flash :</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Classes and structures are capitalized, without underscores.</p>

<p class=Code style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code style='margin-left:.5in'>class HomeyDaClown</p>

<p class=Code style='text-indent:.5in'>struct BigShoe</p>

<p class=MsoNormal><span style='font-family:"Courier New";mso-bidi-font-family:
"Times New Roman";color:blue'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Classes which contain OS dependent code are prefixed Native:</p>

<p class=Code style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code style='margin-left:.5in'>class NativeDisplay</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Method names are also capitalized while member variables are
lower case.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code style='margin-left:.5in'>class EditText</p>

<p class=Code style='margin-left:.5in'>{</p>

<p class=Code style='margin-left:.5in'><span style='mso-tab-count:1'>       </span>void<span
style="mso-spacerun: yes">     </span>HandleKeyDown(int key, int modifiers);</p>

<p class=Code style='margin-left:.5in'><span style='mso-tab-count:1'>       </span>char*<span
style="mso-spacerun: yes">    </span>GetBuffer();</p>

<p class=Code style='margin-left:.5in'><span style='mso-tab-count:1'>       </span>int
<span style='mso-tab-count:1'>   </span><span style="mso-spacerun:
yes">   </span>count;</p>

<p class=Code style='margin-left:.5in'>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Native classes are grouped into files by subject. The
filenames DO NOT have the native prefix – not only is it cumbersome to read but
also is redundant to the module’s placement in a platform subdirectory (see
below.)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>In order to solve the problem of ill-defined integer sizes
in C, the following “six types of integers” are defined by Flash:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code>32 bit unsigned<span style='mso-tab-count:1'>      </span>U32</p>

<p class=Code>32 bit signed <span style='mso-tab-count:2'>             </span>S32</p>

<p class=Code>16 bit unsigned <span style='mso-tab-count:1'>     </span>U16</p>

<p class=Code>16 bit signed <span style='mso-tab-count:2'>             </span>S16</p>

<p class=Code>8 bit unsigned <span style='mso-tab-count:1'>      </span>U8</p>

<p class=Code>8 bit signed<span style='mso-tab-count:2'>         </span>S8</p>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=Code>32 bit signed<span style='mso-tab-count:2'>        </span>BOOL</p>

<p class=Code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Regular “int” is also used where the size and range of the
integer does not matter.</p>

<h3><a name="_Toc463333520"></a><a name="_Toc463949608"></a><a
name="_Toc465251244"><span style='mso-bookmark:_Toc463949608'><span
style='mso-bookmark:_Toc463333520'>Directory Structure</span></span></a></h3>

<p class=MsoNormal>The basic idea is to keep platform independent code in the
main directory, while moving native code to a subdirectory for a given
platform. For instance, the Player directory may have the subdirectories Win32,
Linux, and Mac, each of which contains all the platform dependent code for that
build.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The directory structure for the porting version currently
looks like this:</p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6>Flash Player</h6>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l6 level1 lfo9;
tab-stops:1.0in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>JPEG</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l6 level1 lfo10;
tab-stops:1.0in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>ZLib</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l6 level1 lfo11;
tab-stops:1.0in'><![if !supportLists]>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Win32</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Where JPEG, and ZLib are libraries, and Win32 is a platform
directory.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Therefore, someone wishing to port to a new platform can
clearly see the classes that must be rewritten by browsing a platform
directory. A port starts by copying an existing platform directory (say Win32)
to a new name (Linux) and rewriting the platform dependent code. Path
information linking the core code to the native code is defined in global.h.
The process of porting the Flash code documented in the Roadmap. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Generally, the public methods of a native class cannot be
changed, while the private members and functions should be modified or
rewritten. <span style='layout-grid-mode:line'>Rare exceptions are noted in the
code and documentation. Many native classes have public members which are not
part of the required interface. This is also noted in the code and
documentation.<o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>The ZLib subdirectory
contains lossless decompression for the player. The source code for ZLib, and
resources about its use, can be found at <a
href="http://www.cdrom.com/pub/infozip/zlib/"><span style='layout-grid-mode:
both'>http://www.cdrom.com/pub/infozip/zlib/</span></a>. <o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>The JPeg subdirectory
contains jpeg (lossy) decompression for the player. Source code for JPeg can be
found at the Independent JPegs Group’s homepage, at <a
href="http://www.ijg.org/"><span style='layout-grid-mode:both'>http://www.ijg.org/</span></a>.
More info about JPeg can also be found at http://www.ijg.org/.<o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>Flash icons and cursors
are in the FlashIcon.pcx and FlashIcon.tga in the main Flash directory.<o:p></o:p></span></p>

<h3><a name="_Toc463949609"></a><a name="_Toc465251245"><span style='mso-bookmark:
_Toc463949609'><span style='layout-grid-mode:line'>#defines</span></span></a><span
style='layout-grid-mode:line'><o:p></o:p></span></h3>

<p class=MsoNormal>Various <span style='layout-grid-mode:line'>#define switches
change the configuration and abilities of the player. The important ones are
described here. The #defines that need to be defined by the compiler and used
in every source file are designated <b style='mso-bidi-font-weight:normal'>compiler</b>
in the following list. (Often, this is the –D option on your compiler.)<o:p></o:p></span></p>

<h5 style='margin-left:.5in'>_DEBUG or DEBUG (compiler)</h5>

<p class=MsoBodyTextIndent3><span style='layout-grid-mode:line'>Turns on and
off debugging code.<span style="mso-spacerun: yes">  </span>Normally defined by
your compiler if you are in debug mode.</span></p>

<h5 style='margin-left:.5in'>WIN32,_WINDOWS (compiler)</h5>

<p class=MsoBodyTextIndent3><span style='layout-grid-mode:line'>Necessary for
Windows compilation.<span style="mso-spacerun: yes">  </span>Used by the native
code and the extra (JPEG and ZLib) libraries.</span></p>

<h5 style='margin-left:.5in'>FIXEDUSEFLOAT (<span style='layout-grid-mode:line'>global</span>.h)</h5>

<p class=MsoBodyTextIndent3><span style='layout-grid-mode:line'>When defined,
real numbers are used to perform fixed point mathematics.</span></p>

<h5 style='margin-left:.5in'>USE_JPEG (compiler)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>Turns
on JPEG image processing.</span></p>

<h5 style='margin-left:.5in'>ACTIONSCRIPT (splayer.h)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>Turns
on action scripts. Should normally be set.</span></p>

<h5 style='margin-left:.5in'>EDITTEXT (compiler)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>Turns
on editable text.<o:p></o:p></span></p>

<h5 style='margin-left:.5in'><span style='layout-grid-mode:line'>EDITTEXT_CLIPBOARD_WIDE
(global.h)<o:p></o:p></span></h5>

<p class=MsoBodyTextIndent3>The cut and paste routines, GetStringFromClipboard
and SetStringToClipboard, can be compiled to use ASCII (char*) or Unicode
(U16*). When this define is present, Flash will use a Unicode interface. </p>

<h5 style='margin-left:.5in'>SOUND (compiler)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>Turns
on sound.<o:p></o:p></span></p>

<h5 style='text-indent:.5in'><span style='layout-grid-mode:line'>ONE_SOUND_OBJECT
(global.h)<o:p></o:p></span></h5>

<p class=MsoNormal style='margin-left:.5in'>Applicable if sound is on. If
defined (default), there will be one sound mixer (and presumably, hardware
device) for every SPlayer (the SPlayer is Flash’s “main” object.) This is the
normal situation. In the common case where there is only one SPlayer, this
#define has no effect.</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>If this is not defined, every
SPlayer has its own sound mixer (and, by extension, hardware device
interface.)<span style="mso-spacerun: yes">  </span></p>

<h5 style='margin-left:.5in'>FLASHMP3 (compiler)</h5>

<p class=MsoNormal style='margin-left:.5in'>This define turns on mp3 decoding
in the Flash player. For this to work properly, the Flash code has to link with
Fraunhofer’s mp3 library.</p>

<h5 style='margin-left:.5in'>FRAMESPERSEC (splay.cpp)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>If
set to true, the frame rate is sent to debugger output.<o:p></o:p></span></p>

<h5 style='margin-left:.5in'>SIMULATE_STREAMING and KILOBYTESPERSEC
(PlayerWnd.cpp)</h5>

<p class=MsoNormal style='margin-left:.5in'><span style='layout-grid-mode:line'>These
switches are only defined in the Windows demo code. </span>SIMULATE_STREAMING<span
style='layout-grid-mode:line'> streams in local files like they were coming
from the internet.<span style="mso-spacerun: yes">  </span>If this #define is
not set, local files will be loaded in their entirety (and much more quickly).
The download speed is set by </span>KILOBYTESPERSEC.</p>

<h2><a name="_Toc463333521"></a><a name="_Toc463949613"></a><a
name="_Toc465251246"><span style='mso-bookmark:_Toc463949613'><span
style='mso-bookmark:_Toc463333521'>Major Flash Player Components</span></span></a></h2>

<p class=MsoNormal>A diagram, below, outlines the major components. It is a big
picture view of the code, and should not be taken as something that needs to be
fully understood to follow this document. Classes that inherit each other are
in a vertical block. For instance,<span style="mso-spacerun: yes">  </span><b
style='mso-bidi-font-weight:normal'>ScriptPlayer</b> inherits from <b
style='mso-bidi-font-weight:normal'>ScriptThread</b> which inherits from <b
style='mso-bidi-font-weight:normal'>SParser</b>. Objects that are aggregated or
owned by the class, like a <b style='mso-bidi-font-weight:normal'>CRaster</b>
object inside <b style='mso-bidi-font-weight:normal'>DisplayList</b>, are
referenced with a black line. A blue line indicates the class has a pointer to
the object, but the relationship is more complicated. Either the class does not
own it, or the object is one of several in a list, or some other “non-trivial”
relationship exists.</p>

<p class=MsoNormal><span style="mso-spacerun: yes"> </span></p>

<p class=MsoNormal>After the diagram is a list of flash components and classes
as well as a brief description of their purpose.</p>

<h3><a name="_Toc465251247"><!--[if gte vml 1]><v:shape id="_x0000_i1026"
 type="#_x0000_t75" style='width:456pt;height:273.75pt' o:ole="" fillcolor="window">
 <v:imagedata src="./Design_files/image004.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=608 height=365
src="./Design_files/image005.gif" v:shapes="_x0000_i1026"><![endif]></a><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="PowerPoint.Show.8" ShapeID="_x0000_i1026"
  DrawAspect="Content" ObjectID="_1009376079">
 </o:OLEObject>
</xml><![endif]--></h3>

<h3 style='mso-list:skip'><a name="_Toc463333522"></a><a name="_Toc463949614"></a><a
name="_Toc465251248"><span style='mso-bookmark:_Toc463949614'><span
style='mso-bookmark:_Toc463333522'>Global.h</span></span></a> </h3>

<p class=MsoNormal style='mso-list:skip'>The global file for the project.
Contains the following:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo13;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Paths to the native code.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l1 level1 lfo13;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>#defines that turn on and off various features of
Flash.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo15;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Defines basic types. (U32, S32, …)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo15;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Platform <i style='mso-bidi-font-style:normal'>independent</i>
debugging. Note the following flags which can be #defined in this header or on
your compiler’s command line:</p>

<p class=MsoNormal style='margin-left:.25in'><b style='mso-bidi-font-weight:
normal'>DEBUG </b>puts in debugging code and ASSERTs.</p>

<p class=MsoNormal style='margin-left:.25in;mso-list:skip'><b style='mso-bidi-font-weight:
normal'>PURIFY </b>turns OFF the asserts, but leaves debugging code.</p>

<p class=MsoNormal style='margin-left:.25in;mso-list:skip'>Note that platform <i
style='mso-bidi-font-style:normal'>dependent</i> debugging is in the debug.h
and debug.cpp files in the native subdirectory.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo15;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>A variety of small utility and math functions.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo15;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>A chunk memory allocator for fast allocation of fixed
size memory.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo15;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>And Big or Little Endian declaration. It is important
you set “endianess” for your platform. Failing to do so will cause a compiler
error.</p>

<h3><a name="_Toc463333523"></a><a name="_Toc463949615"></a><a
name="_Toc465251249"><span style='mso-bookmark:_Toc463949615'><span
style='mso-bookmark:_Toc463333523'>class Splayer</span></span></a></h3>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Splayer</b> is the
platform independent code which deals with events (mouse and keyboard),
drawing, cursors, etc. at an OS-independent level. It aggregates the
ScriptPlayer, DisplayList, and CBitBuffer, acting as a platform <i
style='mso-bidi-font-style:normal'>independent</i> &quot;main&quot; object.</p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Splayer interacts with and supports NativePlayerWnd. Their
functionality is similar.</p>

<h3 style='mso-list:skip'><a name="_Toc463333524"></a><a name="_Toc463949616"></a><a
name="_Toc465251250"><span style='mso-bookmark:_Toc463949616'><span
style='mso-bookmark:_Toc463333524'>class NativePlayerWnd : public Splayer</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'><b style='mso-bidi-font-weight:normal'>NativePlayerWnd</b>
functions as the OS <i style='mso-bidi-font-style:normal'>dependent</i> “main”
class of the program.<span style="mso-spacerun: yes">  </span>It contains
Platform specific code for timer implementation, polling the system message
queue, handling mouse and keyboard input, and managing the window on the
screen.</p>

<p class=MsoNormal style='mso-list:skip'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Splayer and NativePlayerWnd together encapsulate a Flash
player instance. There is a one to one correspondence between an
NativePlayerWnd and a movie. This implies that an application which has the
ability to simultaneously play more than one Flash movie needs to have multiple
NativePlayerWnds. Browsers are an example of this configuration. In this case
there needs to be code to manage the various NativePlayerWnds and determine
which one gets mouse and keyboard focus.</p>

<p class=MsoNormal style='mso-list:skip'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>NativePlayerWnd is unusual in that it has a “two way”
interface. <span style='layout-grid-mode:line'>Like all the other classes, </span>NativePlayerWnd
<span style='layout-grid-mode:line'>has public methods that Flash calls.<span
style="mso-spacerun: yes">  </span>However, </span>NativePlayerWnd <span
style='layout-grid-mode:line'>also needs to make calls to Flash (specifically
functions in SPlayer, </span>NativePlayerWnd’s parent) <span style='layout-grid-mode:
line'>when various events occur. Streaming, an interface in its own right, is
described in a separate section.</span></p>

<h4 style='margin-left:.5in;mso-list:skip'><a name="_Toc463949617"></a><a
name="_Toc465251251"><span style='mso-bookmark:_Toc463949617'>Method calls from
Flash Core to NativePlayerWnd</span></a></h4>

<h5 style='margin-left:.5in'>General Method Calls</h5>

<p class=MsoBodyTextIndent3>The “normal” interface to a class, NativePlayerWnd
method calls are described in detail in the <b style='mso-bidi-font-weight:
normal'>Reference</b>. There are calls for stopping and starting timers, sizing
the client window, setting the cursor, and defining menus.</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>NativePlayerWnd Methods:</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>i.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>StartTimer</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>ii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>StopTimer</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>iii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>ClientRect</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>iv.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>UpdateCursor</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>v.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>InvalidateScreenArea</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>vi.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>AdjustWindow</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>vii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>EnableMenus</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>viii.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>GetStringFromClipboard</p>

<p class=MsoBodyTextIndent3 style='margin-left:45.0pt;text-indent:-9.0pt;
mso-list:l10 level3 lfo3'><![if !supportLists]>ix.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><![endif]>SetStringToClipboard</p>

<h4 style='margin-left:.5in'><a name="_Toc463949618"></a><a name="_Toc465251252"><span
style='mso-bookmark:_Toc463949618'>Method calls from NativePlayerWnd to SPlayer</span></a></h4>

<p class=MsoBodyTextIndent3>The following are calls that the NativePlayerWnd
needs to SPlayer (its parent) in response to System Events.</p>

<h5 style='margin-left:.5in'>Timers</h5>

<p class=MsoBodyTextIndent3 style='mso-list:skip'>There are 2 timers – cursor
and player. CursorTimer controls the flashing edit cursor, and PlayerTimer is a
“when to advance the frame count” timing signal. Both timers are started by the
StartTimer call. </p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l13 level1 lfo17;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>When the PlayerTimer fires, it should call DoPlay( true
). </p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l13 level1 lfo17;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>When the CursorTimer fires it should call
BlinkCursor().</p>

<h5 style='margin-left:.5in'>Mouse</h5>

<p class=MsoNormal style='margin-left:.5in;mso-list:skip'>Straightforward,
generally speaking. As with many items in this class, the mouse handling
consists almost entirely of pass through calls to existing Flash code.
Specifically, there are 3 calls that need to be made when mouse events occur:</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l15 level1 lfo19;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>MouseUp when the left mouse is released,</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l15 level1 lfo19;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>MouseDown when the left mouse button is pressed, and</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l15 level1 lfo19;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>MouseMove when the mouse changes position. Note this
needs to be send “at reasonable intervals” whether or not the mouse button is
pressed.</p>

<p class=MsoNormal style='margin-left:.5in'>Mouse capture should be provided for
the client window. When a mouse down occurs in the client window, Flash should
continue to receive mouse motion events until the mouse up, even if the mouse
leaves the client window.</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>If mouse capture is not possible,
Flash should receive mouse up messages when the mouse pointer leaves the client
window.</p>

<h5 style='margin-left:.5in'>Keyboard</h5>

<p class=MsoNormal style='margin-left:.5in;mso-list:skip'>Straightforward, if
tedious, the native code translates from the OS version of key presses to the
Flash definition of a keypresses. The sequence of events is as follows:</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l8 level1 lfo21;
tab-stops:list .75in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>A keydown is detected by the OS.</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l8 level1 lfo21;
tab-stops:list .75in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>SPlayer:: HandleKeyDown should be called, with the following
parameters:</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo23;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The first parameter, <b style='mso-bidi-font-weight:
normal'>key</b>, is a code from the <b style='mso-bidi-font-weight:normal'>Keyboard</b>
class. The native code needs to establish a mapping between the system key
codes and the Flash <b style='mso-bidi-font-weight:normal'>Keyboard</b> class.</p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-.25in;mso-list:l3 level1 lfo23;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>The second parameter, <b style='mso-bidi-font-weight:
normal'>modifiers</b>, are OR’d values from <b style='mso-bidi-font-weight:
normal'>Keyboard</b> class if the SHIFT or CTRL key is pressed.</p>

<p class=MsoNormal style='margin-left:.5in'>NOTE: This is NOT keyboard handling
for the menu system (accelerator keys.) Accelerator are left up to the
implementers.</p>

<h5 style='margin-left:.5in'>Screen and Window Management</h5>

<p class=MsoNormal style='margin-left:.5in'>When the OS informs the native code
of window related changes such as a repaint message, a window resize, palette
change, or screen depth change, Flash core code needs to notified through the
following method calls:</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l18 level1 lfo25;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>A Paint ( or Repaint) event should call Repaint()</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l9 level1 lfo27;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Window Resize event calls FreeBuffer().</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l9 level1 lfo27;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Palette change calls FreeBuffer().</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l9 level1 lfo27;tab-stops:list .75in'><![if !supportLists]><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Screen depth calls FreeBuffer().</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>FreeBuffer is clearly a useful call. When anything
happens that will leave the memory bitmap different from the client window –
resize, depth change, palette change – FreeBuffer should be called. Flash will
respond by querying the current client window state and reconstructing the
bitmap that buffers the client window so that the bitmap has the same size,
depth, and palette as the client window.</p>

<h5 style='margin-left:.5in'>Menus</h5>

<p class=MsoNormal style='margin-left:.5in'>There are 3 types of menus in
Flash:</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l12 level1 lfo29;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b style='mso-bidi-font-weight:normal'>Application
Menu. </b>Is the standard menu at the top of the screen or client window. It is
always available (unless turned off by an FSCommand.)<b style='mso-bidi-font-weight:
normal'><o:p></o:p></b></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l12 level1 lfo29;
tab-stops:list .75in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b style='mso-bidi-font-weight:normal'>Popup Menus. </b>Appear
in response to a right mouse click (or its equivalent.) They have a variety of
flavors depending on where the mouse is when the user clicks on the screen.<b
style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>Not all players will use all menu
choices, or necessarily use menus at all. </p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>The Application Menu contains the
following choices, where the column headings File, View, Control, and Help are
the top level menu items:</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6><span lang=FR style='mso-ansi-language:FR'>Application Menu<o:p></o:p></span></h6>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid black 1.5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border-top:solid black 1.5pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:none;
  background:black;mso-shading:white;mso-pattern:solid black;padding:0in 5.4pt 0in 5.4pt'>
  <h5 style='margin-top:0in'><span lang=FR style='font-family:"Times New Roman";
  color:white;mso-ansi-language:FR'>File<o:p></o:p></span></h5>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;border-top:solid black 1.5pt;
  background:black;mso-shading:white;mso-pattern:solid black;padding:0in 5.4pt 0in 5.4pt'>
  <h5 style='margin-top:0in'><span style='font-family:"Times New Roman";
  color:white'>View<o:p></o:p></span></h5>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;border-top:solid black 1.5pt;
  background:black;mso-shading:white;mso-pattern:solid black;padding:0in 5.4pt 0in 5.4pt'>
  <h5 style='margin-top:0in'><span style='font-family:"Times New Roman";
  color:white'>Control<o:p></o:p></span></h5>
  </td>
  <td width=147 valign=top style='width:110.2pt;border-top:solid black 1.5pt;
  border-left:none;border-bottom:none;border-right:solid black 1.5pt;
  background:black;mso-shading:white;mso-pattern:solid black;padding:0in 5.4pt 0in 5.4pt'>
  <h5 style='margin-top:0in'><span style='font-family:"Times New Roman";
  color:white'>Help<o:p></o:p></span></h5>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open…</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>100%</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Play</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>About Flash Player 4…</p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Close</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Show All</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Rewind</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Create Projector…</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Zoom In</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Step Forward</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Zoom Out</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Step Back</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Exit</p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Full Screen</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Loop</p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border:none;border-left:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border:none;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=122 valign=top style='width:91.35pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=90 valign=top style='width:67.8pt;border:none;border-bottom:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>High Quality</p>
  </td>
  <td width=93 valign=top style='width:69.85pt;border:none;border-bottom:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=147 valign=top style='width:110.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoBodyTextIndent3 style='margin-left:0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>Selecting one of the Application Menu
items results in a method call to a Control* function. The following table
lists the menu items and the function they call. For example, a user selecting
the Open menu would result NativePlayerWnd calling <b style='mso-bidi-font-weight:
normal'>SPlayer::ControlOpen()</b>. The third column contains the states in
which a menu item can exist: enabled (normal), disabled (greyed out), or
checked if the menu item can have a check beside it. If the third column is
blank, the option is always available.</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'>Whenever the menu states change,
the enabled/disabled state is passed to the Native code through the EnableMenus
call. If necessary, the Native code can query the menu state by calling
SPlayer::GetMenuState().</p>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6>File Menu</h6>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid windowtext .75pt;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Open</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlOpen( char*
  filenameToOpen )</b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Close</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlClose()</b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Exit</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Handled by native code.</p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
 </tr>
</table>

<p class=MsoCaption><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoCaption style='margin-left:.5in'>View Menu</p>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid windowtext .75pt;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>100%</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>Control100()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable</p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>View All</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlViewAll()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Zoom In</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlZoomIn()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Zoom Out</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlZoomOut()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Full Screen</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlFullScreen()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><b
  style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=163 valign=top style='width:1.7in;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>High Quality</p>
  </td>
  <td width=282 valign=top style='width:211.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlHighQuality()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>check</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h6>Control Menu</h6>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid windowtext .75pt;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=169 valign=top style='width:126.9pt;border:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Play</p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlPlay()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .75pt;
  border-left:none;mso-border-left-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable</p>
  </td>
 </tr>
 <tr>
  <td width=169 valign=top style='width:126.9pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Rewind</p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlRewind()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=169 valign=top style='width:126.9pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>StepForward</p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlForward()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=169 valign=top style='width:126.9pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>StepBack</p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlBack()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=169 valign=top style='width:126.9pt;border:solid windowtext .75pt;
  border-top:none;mso-border-top-alt:solid windowtext .75pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Loop</p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>ControlLoop()<o:p></o:p></b></p>
  </td>
  <td width=145 valign=top style='width:108.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .75pt;border-right:solid windowtext .75pt;
  mso-border-top-alt:solid windowtext .75pt;mso-border-left-alt:solid windowtext .75pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>enable/disable, check<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>
  </td>
 </tr>
</table>

<p class=MsoBodyTextIndent3 style='margin-left:0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>There are 5 configurations of popup menu. When the
right click occurs, the current configuration can be queried with
SPlayer::GetPopupMenuState(). It returns one of the following values:</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l7 level1 lfo31;tab-stops:list .75in'><![if !supportLists]>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>MENU_EDIT. Meaning that the cursor is on an editable text
field.</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l7 level1 lfo31;tab-stops:list .75in'><![if !supportLists]>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>MENU_NONE. An almost completely empty menu.</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l7 level1 lfo31;tab-stops:list .75in'><![if !supportLists]>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>MENU_NO_MOVIE. The menu when there is no movie playing.</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l7 level1 lfo31;tab-stops:list .75in'><![if !supportLists]>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>MENU_NORMAL. When there is a multi frame movie playing.</p>

<p class=MsoBodyTextIndent3 style='margin-left:.75in;text-indent:-.25in;
mso-list:l7 level1 lfo31;tab-stops:list .75in'><![if !supportLists]>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>MENU_STATIC. When there is a single frame movie playing.</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>The edit text menu is unique and described below.
The other 4 choices are subsets of the Application Menu. So each configuration
has a subset of the 16 possible menu items, and each item can be enabled,
disabled, or checked.</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>The table below lists the possible menu items in
the left column. The other columns are the configurations and whether an item
appears in that configuration.</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3><b style='mso-bidi-font-weight:normal'>Popup Menu</b></p>

<table border=0 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><b
  style='mso-bidi-font-weight:normal'><span style='color:blue'>NONE<o:p></o:p></span></b></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><b
  style='mso-bidi-font-weight:normal'><span style='color:blue'>NO_MOVIE<o:p></o:p></span></b></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><b
  style='mso-bidi-font-weight:normal'><span style='color:blue'>NORMAL<o:p></o:p></span></b></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><b
  style='mso-bidi-font-weight:normal'><span style='color:blue'>STATIC<o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'>Zoom In</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><span
  style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><span
  style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Zoom Out</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>100%</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>High Quality</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Play</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Loop</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Rewind</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Forward</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Back</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Movie Not Loaded…</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='color:blue'><o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=147 valign=top style='width:110.2pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>About Flash Player 4…</p>
  </td>
  <td width=58 valign=top style='width:43.6pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=91 valign=top style='width:68.05pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=78 valign=top style='width:58.8pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
  <td width=68 valign=top style='width:50.9pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='color:blue'>yes<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-left:1.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>“Zoom In” works differently between the Application
and Popup menus. In the Popup, “Zoom In” zooms to the point that was right
clicked. In the Application Menu, “Zoom In” zooms to the center of the screen.
“Movie Not Loaded…” only appears on the Popup Menu, and then only if the movie
isn’t loaded. This option is never selectable.</p>

<p class=MsoBodyTextIndent3><span style="mso-spacerun: yes"> </span></p>

<p class=MsoBodyTextIndent3>The Edit Text Popup Menu contains the following
choices, relating to cut and paste actions:</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3><b style='mso-bidi-font-weight:normal'>Edit Text
Popup Menu<o:p></o:p></b></p>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'>Undo</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Cut</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Copy</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Paste</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Delete</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>(separator)</p>
  </td>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Select All</p>
  </td>
 </tr>
</table>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyTextIndent3>Undo is not currently implemented for either the
Win32 Demo or the Win32 Flash Player.</p>

<p class=MsoBodyTextIndent3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.5in'><a name="_Toc463949619"></a><a
name="_Toc465251253"></a><a name="_Toc463333525"><span style='mso-bookmark:
_Toc465251253'><span style='mso-bookmark:_Toc463949619'>For the Edit Text Popup
Menu, selecting a menu choice results in a keypress being sent to Flash. The
following table lists the menu items and the keypress that results when they
are selected. Any edit text option can be enabled or disabled. The
enabled/disabled state can be queried with SPlayer::GetEditMenuState().</span></span></a></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'><span
style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'><span
style="mso-spacerun: yes"> </span></span></span></span></p>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:.5in;border-collapse:
 collapse;border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><span
  style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'>Undo</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><span
  style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'>not implemented.</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Cut</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>ID_KEY_CUT</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Copy</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>ID_KEY_COPY</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Paste</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>ID_KEY_PASTE</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Delete</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>ID_KEY_CLEAR</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
 <tr>
  <td width=145 valign=top style='width:108.9pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Select
  All</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><span
  style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>ID_KEY_SELECT_ALL</span></span></span></p>
  </td>
  <span style='mso-bookmark:_Toc463333525'><span style='mso-bookmark:_Toc465251253'><span
  style='mso-bookmark:_Toc463949619'></span></span></span>
 </tr>
</table>

<h4 style='margin-left:.5in;mso-list:skip'><span style='mso-bookmark:_Toc463333525'><span
style='mso-bookmark:_Toc465251253'><span style='mso-bookmark:_Toc463949619'>Streaming</span></span></span></h4>

<p class=MsoBodyTextIndent3><span style='mso-bookmark:_Toc463333525'>Streaming
refers to retrieving URLs: whether they are local files, remote files, web
pages, or other types entirely. The streaming code is very similar to the Netscape
plug-in architecture; please refer to </span><a
href="http://developer.netscape.com/docs/manuals/"><span style='mso-bookmark:
_Toc463333525'>http://developer.netscape.com/docs/manuals/</span><span
style='mso-bookmark:_Toc463333525'></span></a><span style='mso-bookmark:_Toc463333525'>.</span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'>The
sequence of calls proceeds as follows:</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l2 level1 lfo33;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Flash calls StreamPostURLNotify or StreamGetURLNotify to request
a stream. If the URL requested is not a SWF file, the page may need to be
loaded, the mail client may need to be informed, etc. However, from the point
of view of Flash core, this call is informative only. There is no return value
and no expected behavior. If the network code does start streaming a SWF file,
then it can proceed to step 2.</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l2 level1 lfo33;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>The Native code calls StreamInNew. The call can (and probably
will) be made some time after the GET or POST. The subtlety is that Flash has
only one thread and all calls need to be on that thread; it may be necessary
pass information back to the main thread in native code before making the call
to StreamInNew.</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l2 level1 lfo33;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>The Native code calls StreamInWrite as many times as needed to
send SWF packets to the Flash core.</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l2 level1 lfo33;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>StreamInDestroy should be called when the writes are complete.</span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'>If
Flash wishes to stop the streaming (after a StreamInNew), it will call the
Native method CloseStream. The most basic functionality of this call should be
to set streamData-&gt;scriptPlayer to NULL. That way, future calls to
StreamInWrite and StreamInDestroy will not write SWF data. It is a good idea to
call StreamInDestroy on the closed stream to clean up memory.</span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'>Another
possible sequence is that the player decides to initiate the streaming of a SWF
by jumping directly to step 2. This is useful for a plug-in to begin loading a
URL. </span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463333525'>If
used to initiate streaming, it is possible the incoming stream will conflict
with the existing movie. The two obvious ways to avoid this problem:</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l14 level1 lfo35;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Only use StreamGetURLNotify to load the first movie - useful
for plugins.</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l14 level1 lfo35;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463333525'><![if !supportLists]>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Use ControlOpen instead to start streaming, which will clear
existing movies and strings.</span></p>

<p class=MsoNormal><span style='mso-bookmark:_Toc463333525'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyTextIndent3><span style='mso-bookmark:_Toc463333525'>The
interface in completely generic. The Streaming calls need to be able to handle
(or ignore) any type of URL. Local files, remote files, and web addresses are
all handled through this interface.</span></p>

<p class=MsoBodyTextIndent3><span style='mso-bookmark:_Toc463333525'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyTextIndent3><span style='mso-bookmark:_Toc463333525'>Related to
streaming are FSCommands, which sends a command from the movie to the player.
For instance, if the player is in a browser, this can be a JavaScript method
call. Please see the Flash 4 help file on FSCommand for a complete description
of all the commands and arguments that FSCommand can issue. The NativePlayerWnd
method ProcessFSCommand implements FSCommand handling.</span></p>

<h3 style='mso-list:skip'><span style='mso-bookmark:_Toc463333525'><a
name="_Toc463949620"></a><a name="_Toc465251254"><span style='mso-bookmark:
_Toc463949620'>class SParser</span></a></span></h3>

<p class=MsoNormal style='mso-list:skip'>Low level parsing of a SWF file.
SParser has methods to read a SWF stream.</p>

<h3 style='mso-list:skip'><a name="_Toc463333526"></a><a name="_Toc463949621"></a><a
name="_Toc465251255"><span style='mso-bookmark:_Toc463949621'><span
style='mso-bookmark:_Toc463333526'>class ScriptThread : public SParser</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>The <b style='mso-bidi-font-weight:
normal'>ScriptThread</b> handles the flow of control and parsing for a
timeline. It has many functions for adding bits, fonts, sounds, and objects. It
handles tags in the source file and processes frames. A large class, which is
itself a linked list.<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>

<h3 style='mso-list:skip'><a name="_Toc463333527"></a><a name="_Toc463949622"></a><a
name="_Toc465251256"><span style='mso-bookmark:_Toc463949622'><span
style='mso-bookmark:_Toc463333527'>class ScriptPlayer : public ScriptThread</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>Where the actual bits of the SWF file
lives. The <b style='mso-bidi-font-weight:normal'>ScriptPlayer</b> handles
streaming and the character dictionary.</p>

<p class=MsoNormal style='mso-list:skip'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoNormal style='mso-list:skip'>When the SWF header arrives, <b
style='mso-bidi-font-weight:normal'>ScriptPlayer::PushDataBuf()</b> allocates a
block of memory big enough for the entire file. (Something to keep in mind,
clearly.) <b style='mso-bidi-font-weight:normal'>PushData()</b> gets called as
data gets streamed in – all data comes through <b style='mso-bidi-font-weight:
normal'>PushData()</b>.</p>

<h3 style='mso-list:skip'><a name="_Toc463333528"></a><a name="_Toc463949623"></a><a
name="_Toc465251257"><span style='mso-bookmark:_Toc463949623'><span
style='mso-bookmark:_Toc463333528'>class DisplayList</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'><b style='mso-bidi-font-weight:normal'>DisplayList</b><span
style="mso-spacerun: yes">  </span>holds the list of <b style='mso-bidi-font-weight:
normal'>SObjects</b> to be drawn. It stores the dirty rectangle information and
manages the redrawing of the screen. Contains a <b style='mso-bidi-font-weight:
normal'>CRaster</b> class, where the routines to draw to the bitmap live. Also
has a pointer to the active <b style='mso-bidi-font-weight:normal'>ScriptThread</b>
list.</p>

<p class=MsoNormal style='mso-list:skip'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='mso-list:skip'>Objects are managed by being placed,
moved, and removed. <b style='mso-bidi-font-weight:normal'>DisplayList</b>
keeps the dirty rectangles current when these actions occur.</p>

<h3 style='mso-list:skip'><a name="_Toc463333529"></a><a name="_Toc463949624"></a><a
name="_Toc465251258"><span style='mso-bookmark:_Toc463949624'><span
style='mso-bookmark:_Toc463333529'>struct SObject</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>Anything on the display list.
Encapsulates an on screen object. Includes placement, size, and z-depth
information. It can also draw itself and check mouse hit regions.</p>

<h3 style='mso-list:skip'><a name="_Toc463333532"></a><a name="_Toc463949627"></a><a
name="_Toc465251259"><span style='mso-bookmark:_Toc463949627'><span
style='mso-bookmark:_Toc463333532'>class CRaster</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>All the functionality to draw shapes
and set pixels in a memory bitmap – in this case <b style='mso-bidi-font-weight:
normal'>CBitBuffer</b>.</p>

<h3 style='mso-list:skip'><a name="_Toc463333533"></a><a name="_Toc463949628"></a><a
name="_Toc465251260"><span style='mso-bookmark:_Toc463949628'><span
style='mso-bookmark:_Toc463333533'>class CBitBuffer</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>This class defines a bitmap in memory.
It points to a NativeBitmap, which actually allocates the memory for the screen
backbuffer. CBitBuffer provides an interface between the Flash core and the
NativeBitmap.</p>

<h3 style='mso-list:skip'><a name="_Toc463333534"></a><a name="_Toc463949629"></a><a
name="_Toc465251261"><span style='mso-bookmark:_Toc463949629'><span
style='mso-bookmark:_Toc463333534'>class NativeBitmap</span></span></a></h3>

<p class=MsoNormal>Many OSs have a rather specific idea of what a bitmap is.
NativeBitmap wraps this OS dependent object and presents an interface to the
main Flash code. The closer the OS bitmap is to a block of bits in memory (as
opposed to an abstract object) the easier it will be to port, and the better
the results will be. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Flash will create and destroy the NativeBitmap in order that
it has the same dimensions as the screen.</p>

<h3 style='mso-list:skip'><a name="_Toc463333535"></a><a name="_Toc463949630"></a><a
name="_Toc465251262"><span style='mso-bookmark:_Toc463949630'><span
style='mso-bookmark:_Toc463333535'>class NativeDisplayTester</span></span></a></h3>

<p class=MsoNormal>Provides an interface to detect the graphics
settings/capabilities of the display device. Flash uses this information to
decide:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo36;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>what color depth is in use</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo36;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>whether to use a palette</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l0 level1 lfo36;
tab-stops:.25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>the orientation of screen memory..</p>

<h3><a name="_Toc463333537"></a><a name="_Toc463949631"></a><a
name="_Toc465251263"><span style='mso-bookmark:_Toc463949631'><span
style='mso-bookmark:_Toc463333537'>class NativePalette</span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'>The <b style='mso-bidi-font-weight:
normal'>NativePalette</b>’s sole method queries the current screen palette. If
the display device is palettized, the Flash core code will need to query the
palette whenever it constructs a bitmap. (Which occurs whenever the client
window size changes, the palette changes, or the color depth changes.)</p>

<h3><a name="_Toc463333538"></a><a name="_Toc463949632"></a><a
name="_Toc465251264"><span style='mso-bookmark:_Toc463949632'><span
style='mso-bookmark:_Toc463333538'>struct SColorInfo</span></span></a> </h3>

<p class=MsoNormal style='mso-list:skip'><b style='mso-bidi-font-weight:normal'>SColorInfo</b>
is a Flash palette, containing the color entries, size, and RGB to palette map
conversion. <b style='mso-bidi-font-weight:normal'>SColorInfo</b> has been
expanded so that OS specific code can be linked to the <b style='mso-bidi-font-weight:
normal'>SColorInfo</b> data.</p>

<p class=MsoNormal style='mso-list:skip'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoNormal>Flash has it’s own internal notion of a palette which is
ScolorInfo. Hooks have been added to ScolorInfo if the OS has a concept of a Palette
object or needs special palette functions. So if an OS object needs to be
maintained along with the Flash palette, the CreateOSPalette and
DestroyOSPalette methods can be used to accomplish this.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The ScolorInfo methods belonging solely to the Flash Player
(and not needing modification) are in the file bitbuf.cpp.</p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The native (hookable) methods of SColorInfo are in
palette.cpp.<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></p>

<h3 style='mso-list:skip'><a name="_Toc463333530"></a><a name="_Toc463949625"></a><a
name="_Toc465251265"></a><a name="_Toc463333539"></a><a name="_Toc463949633"><span
style='mso-bookmark:_Toc463333539'><span style='mso-bookmark:_Toc465251265'><span
style='mso-bookmark:_Toc463949625'><span style='mso-bookmark:_Toc463333530'>class
CSound</span></span></span></span></a></h3>

<p class=MsoNormal style='mso-list:skip'><span style='mso-bookmark:_Toc463949633'><span
style='mso-bookmark:_Toc463333539'>Defines a sound sample, in terms of its
format, channels, frequency, and length. Basically a wrapper class to raw sound
data.<span style="mso-spacerun: yes">  </span></span></span></p>

<h3><span style='mso-bookmark:_Toc463949633'><span style='mso-bookmark:_Toc463333539'><a
name="_Toc465251266"></a><a name="_Toc463333531"></a><a name="_Toc463949626"><span
style='mso-bookmark:_Toc463333531'><span style='mso-bookmark:_Toc465251266'>class
CSoundChannel</span></span></a></span></span></h3>

<p class=MsoNormal style='mso-list:skip'><span style='mso-bookmark:_Toc463949633'><span
style='mso-bookmark:_Toc463333539'><span style='mso-bookmark:_Toc463949626'><span
style='mso-bookmark:_Toc463333531'>The same sound playing multiple times uses
the same CSound object. CSoundChannel is an actual instance of a CSound that is
getting send to the mixer. It contains envelope and position information for playback.
CSoundChannel objects are added to the mixer with CSoundMix::AddSound.</span></span></span></span></p>

<h3 style='mso-list:skip'><span style='mso-bookmark:_Toc463949633'><span
style='mso-bookmark:_Toc463333539'><span style='mso-bookmark:_Toc463949626'><span
style='mso-bookmark:_Toc463333531'><a name="_Toc465251267">class CSoundMix</a></span></span></span></span></h3>

<p class=MsoNormal style='mso-list:skip'><span style='mso-bookmark:_Toc463949633'><span
style='mso-bookmark:_Toc463333539'>A global sound mixing object. It takes all
the sound channels and combines them into one output buffer.</span></span></p>

<h3><span style='mso-bookmark:_Toc463949633'><span style='mso-bookmark:_Toc463333539'><a
name="_Toc465251268">class NativeSoundMix : public CSoundMix</a></span></span></h3>

<p class=MsoNormal>Sound is a tricky problem. Very possibly the element that
differs most from OS to OS. So there are two interfaces provided for sound: a
callback approach or a polled approached. In studying various OS
implementations of sound, it is impossible to extract a single interface that
is both thin and portable. (There are fundamental architecture differences in
the sound code – single vs. multi threaded and polled vs. callback. Portable
interfaces are not thin, and thin interfaces are not portable.)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>So rather than enforce a particular style of interface,
documentation and hooks are provided for the implementers to integrate their OS
sound support as they see fit.</p>

<h4><a name="_Toc465251269">Architecture of the Sound System</a></h4>

<p class=MsoNormal>The greatest part of the sound code is remarkably platform
independent. The sound data (CSound) and the instances of that data
(CSoundChannel, which contains envelope and state information) are completely
platform independent code.<span style="mso-spacerun: yes">  </span>However the
sound mixer, CSoundMix and NativeSoundMix, interfaces with a hardware device.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>CSoundMix mixes the currently playing CSoundChannel objects
to a sound buffer, and streams it out via NativeSoundMix. (The actual details
of this procedure are rather involved.) CSoundMix maintains several small sound
buffers (of count nBuffers, specifically) that may contain sound sample data.
More buffers can be dynamically allocated, if necessary. Buffer size in bytes
and the maximum possible number of buffers are set for every system.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>At any time a buffer may be unused (and ready to be used),
contain sound data being played, contain sound data in a play queue, or contain
data already played and ready to be reused. The Native code manages the
buffers. Some systems may only need 2 buffers, one for the playing code and one
to write new sound to, while other systems work better with relatively many
small buffers queued to play.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Very often, there will need to be a second thread to handle
sound. It of course shares data with the main Flash thread, so a mutex
semaphore is necessary to synchronize the data access. EnterCritical and
LeaveCritical wrap access to sound data. The details of how the semaphore is
implemented is left to the native code. A description of the Win32 code is
presented below.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>There are two approaches to implementing sound:</p>

<h5 style='margin-left:.5in'><a name="_Toc463949635"></a><a name="_Toc463949634"><span
style='mso-bookmark:_Toc463949635'>PollSound</span></a></h5>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463949634'>The
PollSound function is called by CRaster while it paints. This guarantees
frequent calls to check and update the status of the sound system. This is
conceptually simple: the sound engine is polled very often, and it performs the
following tasks:</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l17 level1 lfo38;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463949634'><![if !supportLists]>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>If a buffer is completed playing, it calls MarkBufferComplete
which flags the buffer for reuse.</span></p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in;mso-list:l17 level1 lfo38;
tab-stops:list .75in'><span style='mso-bookmark:_Toc463949634'><![if !supportLists]>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>New sound is loaded into the free’d buffers.</span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='mso-bookmark:_Toc463949634'>Perhaps
the best part of the pollsound approach is one thread. So there is no need for
the mutex semaphore. On the other hand, it’s polled. There is potentially
significant performance loss from the polling.</span></p>

<h5 style='margin-left:.5in'><span style='mso-bookmark:_Toc463949634'>Callback</span></h5>

<p class=MsoHeader style='margin-left:.5in;tab-stops:.5in center 3.0in right 6.0in'>Callbacks,
and the implementation thereof, are extremely OS dependent. When a buffer
completes, it calls the callback which in turn calls MarkBufferComplete and
then builds new buffers. Though potentially much more efficient, it is not a
simple process. The entire process is analyzed below.</p>

<p class=MsoHeader style='tab-stops:.5in center 3.0in right 6.0in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The sound architecture of a given OS usually implies one
solution or the other. </p>

<h4><a name="_Toc465251270">Analysis of Win32 Sample Code</a></h4>

<p class=MsoNormal>The Win32 is a callback approach which actually uses an
additional thread. It’s about as complicated as the situation can get, and
hopefully represents a superset of other implementations. The three threads
involved in sound are:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l11 level1 lfo40;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Flash main thread</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l11 level1 lfo40;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>A callback thread</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l11 level1 lfo40;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Buffer processing thread</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>CSoundMix::AddSound</span>.
Addsound is the entry point called when the Flash player wants to add another
CSoundChannel to the output. A majority of the AddSound call is processing the
CSoundChannel and getting it ready for the mixer. After that, AddSound calls</p>

<p class=Code><span style='font-family:"Times New Roman"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-tab-count:1'>                </span><span
style='color:blue'>CSoundMix::EnterCritical</span>. The shared sound data is
now being accessed.</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>Various</span>
data processing and cleanup occurs, including linking the CSoundChannel into
the list of CSoundChannels being played. If the sound device is already open,
this is essentially the only important thing Addsound has to do. When the time
is right, the CSoundChannel will start getting mixed in.</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix::OpenDevice</span>
called if the device <b style='mso-bidi-font-weight:normal'>is not</b> already
open. A more innocent looking call than it actually is. OpenDevice contains the
following method calls:</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>{</span></p>

<p class=MsoNormal style='margin-left:1.0in'><span style='color:blue'>NativeSoundMix::GetNativeSoundCap
</span>which gets the device capabilities.</p>

<p class=MsoNormal style='margin-left:1.0in'><span style='color:blue'>NativeSoundMix::OpenNativeDevice</span>
which opens the hardware device.</p>

<p class=MsoNormal style='margin-left:1.0in'><span style='color:blue'>CSoundMix::AllocBuffers
</span>then allocates the memory buffers which store the sound snippets to be
written.</p>

<p class=MsoNormal style='margin-left:1.0in'><span style='color:blue'><span
style="mso-spacerun: yes"> </span>NativeSoundMix::BuildAndWrite </span>is
called twice to pack and send buffers with silence to the hardware player. The
silence is used to initialize the sound stream. BuildAndWrite is described
below.</p>

<p class=MsoNormal style='margin-left:1.0in'><span style='color:blue'>NativeSoundMix::BuffersReady
</span>then gets called. This is to inform the native code that the device is
open, the buffers are allocated, and the buffers are filled with data. Win32
uses this as the signal to fire off the buffer processing thread which monitors
the playing sounds.</p>

<p class=MsoNormal><span style='color:blue'><span style='mso-tab-count:1'>                </span>}</span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix::LeaveCritical</span>
ends the AddSound processing.</p>

<p class=Code><span style='font-family:"Times New Roman"'>}<o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>At “other end” of the sound processing, is the callback when
a sound completes. (In the polling approach, the polling code would realize
that the sound has completed, and events proceed in much the same way.) </p>

<p class=Code><span style='font-family:"Times New Roman";color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>MixCallback is called when a buffer has completed. It calls
CSoundMix::MarkBufferComplete to mark the buffer ready for re-use, and then
flags a the semaphore indicating that the buffers need to be filled. This is a result
of the windows architecture; on other systems the functionality of the DoPlay
function could be part of<span style="mso-spacerun: yes">  </span>the callback.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><span style='color:blue'>NativeSoundMix::DoPlay</span> is
waiting for the semaphore to be flagged. When flagged, the buffer has completed
playing, and a call is made to:</p>

<p class=MsoNormal><span style='color:blue'>{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix:EnterCritical</span>.
</p>

<p class=MsoNormal style='margin-left:.5in'>If the hardware device is closed,
or the semaphore is gone, the thread terminates. It will start again next time
the Sound Device gets opened. </p>

<p class=MsoNormal style='margin-left:.5in'>The native code maintains the Win32
WAVEHDR structure describing each buffer, which parallels the core WaveHeader
structure. (Both structures are referenced by the same index so they won’t get
out of sync.)<span style="mso-spacerun: yes">  </span>So for all the buffers
not in use,</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>NativeSoundMix::BuildAndWrite</span>
is called. The buffers are packed with sound by making a call to BuildBuffer
and specifying the number of an available buffers. So the Win32 generally has
multiple buffers queued to the hardware.</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix:EnlargeBuffers</span>
is called <b style='mso-bidi-font-weight:normal'>if</b> the number of buffers
sent to the hardware is in danger of overwhelming the number of buffers
available.</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix:CloseDevice</span>
is called <b style='mso-bidi-font-weight:normal'>if</b> the player has reverted
to silence.</p>

<p class=MsoNormal style='margin-left:.5in'><span style='color:blue'>CSoundMix:LeaveCritical</span>
ends the function. </p>

<p class=Code><span style='font-family:"Times New Roman"'>}<o:p></o:p></span></p>

<h4><a name="_Toc465251271">MP3</a></h4>

<p class=MsoNormal>The MP3 code is build around a library (mp3decoder.lib in
the Windows version) and header files provided by Fraunhofer. The mp3 headers
are:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo42;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>mp3decifc.h</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo42;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>mp3sscdef.h</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo42;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>mp3streaminfo.h</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo42;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>mpegbitstream.h</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in;mso-list:l5 level1 lfo42;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>mpegheader.h</p>

<p class=MsoNormal>Fraunhofer maintains copyrights to the code and library. For
Flash versions that do not support MP3, or do not have the Fraunhofer library,
the FLASHMP3 #define may be removed.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
